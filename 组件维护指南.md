### 组件维护指南（基础版）

- **目录约定**
  - **schema 类型定义**：`frontend/src/core/schema/basic.ts`、`frontend/src/core/schema/types.ts`
  - **默认配置（config）**：`frontend/src/config/*.config.ts`
  - **表单元数据（meta）**：`frontend/src/config/meta/*.meta.ts`
  - **渲染组件（materials）**：`frontend/src/components/materials/basic/*`
  - **组件注册表**：`frontend/src/components/materials/registry.ts`
  - **拖拽创建默认节点**：`frontend/src/config/index.ts`

- **新增一个基础组件的步骤（以 Clock 为例）**
  - **1. 定义类型**
    - 在 `core/schema/types.ts` 中为组件添加 `ComponentType` 枚举值，例如：`'Clock'`。
    - 在 `core/schema/basic.ts` 中新增对应的接口，例如 `ClockComponent`，并把它加入 `ComponentNode` 联合类型中。
  - **2. 定义默认配置**
    - 在 `config` 目录新增 `xxx.config.ts`，导出 `xxxDefaultConfig`，类型为对应的组件接口。
    - 配置中要包含：`id`、`type`、`name`、`props`（业务配置）、`style`（尺寸和位置）等字段。
  - **3. 定义表单元数据（meta）**
    - 在 `config/meta` 下新增 `xxx.meta.ts`，使用 `FieldMeta` 为每个 `props` 字段补充：
      - `title`（显示名称）、`widget`（使用的控件类型）、`enum`、`placeholder`、`minimum` / `maximum` 等。
    - 这些元数据用于驱动 `form-render` 自动生成配置表单。
  - **4. 编写渲染组件**
    - 在 `components/materials/basic` 下新增对应的 React 组件文件，例如 `Clock.tsx`。
    - 组件通过 `RendererProps` 接收节点数据，将 `node.props` 断言为具体组件 props，并根据配置渲染 UI。
  - **5. 注册到组件注册表**
    - 在 `components/materials/registry.ts` 中：
      - `import` 新组件；
      - 使用 `ComponentRegistryManager.register("Clock", Clock as unknown as RegistryComponent);` 注册。
  - **6. 配置默认拖拽创建逻辑**
    - 在 `config/index.ts` 的 `componentDefaultConfigs` 中加入新组件的默认配置映射：
      - 例如：`'Clock': clockDefaultConfig`。
    - 这样在画布中拖拽该组件时，会基于默认配置创建一个新实例。
  - **7. 在组件面板中暴露入口（可选，但推荐）**
    - 在 `components/panels/component-panel/BasicPanel.tsx` 中：
      - 为新组件添加一项，指定 `type`、`name` 和图标；
      - `type` 必须和 schema 中的 `type` 保持一致。

- **表单配置联动说明**
  - 属性面板使用 `form-render`（XRender）根据 Schema 自动渲染表单。
  - 当前示例实现以 Text 为试点，使用：
    - 默认配置 → `to-json-schema` 推导结构 → `config/meta/*.meta.ts` 补充 UI 信息 → 生成兼容 form-render 的 Schema。
  - 如需为新组件接入自动配置表单：
    - 参考 `utils/formSchema.ts` 中 Text 的实现，为新组件编写对应的 Schema 生成函数；
    - 在属性面板中，根据 `node.type` 选择不同的 Schema 与 `form` 实例。

